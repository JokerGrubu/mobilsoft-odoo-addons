<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="res_config_settings_view_form_qnb" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.qnb</field>
        <field name="model">res.config.settings</field>
        <field name="inherit_id" ref="base.res_config_settings_view_form"/>
        <field name="priority">50</field>
        <field name="arch" type="xml">
            <xpath expr="//form" position="inside">
                <app data-string="QNB e-Solutions" string="QNB e-Solutions" name="mobilsoft_qnb_efatura" groups="account.group_account_manager">
                    <block title="API Baƒülantƒ± Ayarlarƒ±" name="qnb_connection_settings">
                        <setting id="qnb_enabled" string="QNB e-Solutions Entegrasyonu" 
                                 help="QNB e-Solutions e-Fatura/e-Ar≈üiv/e-ƒ∞rsaliye entegrasyonunu etkinle≈ütirin">
                            <field name="qnb_enabled"/>
                        </setting>
                        <setting id="qnb_environment" string="Ortam" invisible="not qnb_enabled"
                                 help="Test: connectortest.efinans.com.tr / Canlƒ±: connector.efinans.com.tr">
                            <field name="qnb_environment" widget="radio"/>
                        </setting>
                        <setting id="qnb_credentials" string="API Bilgileri" invisible="not qnb_enabled">
                            <div class="row mt16">
                                <label for="qnb_username" string="Kullanƒ±cƒ± Adƒ± (VKN)" class="col-lg-3 o_light_label"/>
                                <field name="qnb_username" class="col-lg-4" placeholder="1234567890"/>
                            </div>
                            <div class="row mt16">
                                <label for="qnb_password" string="≈ûifre" class="col-lg-3 o_light_label"/>
                                <field name="qnb_password" class="col-lg-4" password="True"/>
                            </div>
                            <div class="row mt16">
                                <label for="qnb_wsdl_url" string="√ñzel WSDL URL (Opsiyonel)" class="col-lg-3 o_light_label"/>
                                <field name="qnb_wsdl_url" class="col-lg-6" 
                                       placeholder="https://erpefaturatest1.qnbesolutions.com.tr/efatura/ws/connectorService?wsdl"/>
                            </div>
                            <div class="mt16">
                                <button name="action_test_qnb_connection" type="object" 
                                        string="Baƒülantƒ±yƒ± Test Et" class="btn-primary" icon="fa-plug"/>
                            </div>
                        </setting>
                    </block>

                    <block title="e-Fatura Ayarlarƒ±" name="qnb_efatura_settings" invisible="not qnb_enabled">
                        <setting id="qnb_efatura_enabled" string="e-Fatura Aktif">
                            <field name="qnb_efatura_enabled"/>
                        </setting>
                        <setting id="qnb_efatura_scenario" string="Fatura Senaryosu" invisible="not qnb_efatura_enabled">
                            <field name="qnb_efatura_scenario" widget="radio"/>
                        </setting>
                        <setting id="qnb_efatura_prefix" string="Seri √ñneki" invisible="not qnb_efatura_enabled">
                            <field name="qnb_efatura_prefix" placeholder="EF"/>
                        </setting>
                    </block>

                    <block title="e-Ar≈üiv Ayarlarƒ±" name="qnb_earsiv_settings" invisible="not qnb_enabled">
                        <setting id="qnb_earsiv_enabled" string="e-Ar≈üiv Aktif">
                            <field name="qnb_earsiv_enabled"/>
                        </setting>
                        <setting id="qnb_earsiv_prefix" string="Seri √ñneki" invisible="not qnb_earsiv_enabled">
                            <field name="qnb_earsiv_prefix" placeholder="EA"/>
                        </setting>
                        <setting id="qnb_earsiv_send_type" string="G√∂nderim Tipi" invisible="not qnb_earsiv_enabled">
                            <field name="qnb_earsiv_send_type" widget="radio"/>
                        </setting>
                    </block>

                    <block title="e-ƒ∞rsaliye Ayarlarƒ±" name="qnb_eirsaliye_settings" invisible="not qnb_enabled">
                        <setting id="qnb_eirsaliye_enabled" string="e-ƒ∞rsaliye Aktif">
                            <field name="qnb_eirsaliye_enabled"/>
                        </setting>
                        <setting id="qnb_eirsaliye_prefix" string="Seri √ñneki" invisible="not qnb_eirsaliye_enabled">
                            <field name="qnb_eirsaliye_prefix" placeholder="IR"/>
                        </setting>
                    </block>

                    <block title="≈ûirket e-Fatura Bilgileri" name="qnb_company_info" invisible="not qnb_enabled">
                        <setting id="qnb_gib_alias" string="Gƒ∞B Posta Kutusu Etiketi">
                            <field name="qnb_gib_alias" placeholder="urn:mail:defaultpk@xxx.com"/>
                        </setting>
                        <setting id="qnb_sender_alias" string="G√∂nderici Etiketi">
                            <field name="qnb_sender_alias"/>
                        </setting>
                    </block>

                    <block title="Otomatik ƒ∞≈ülemler" name="qnb_auto_settings" invisible="not qnb_enabled">
                        <setting id="qnb_auto_fetch" string="Gelen Belgeleri Otomatik Al"
                                 help="Gelen e-Fatura ve e-ƒ∞rsaliyeleri otomatik olarak indir">
                            <field name="qnb_auto_fetch_incoming"/>
                        </setting>
                        <setting id="qnb_auto_fetch_outgoing" string="Giden Belgeleri Otomatik Al"
                                 help="Giden e-Fatura ve e-Ar≈üiv faturalarƒ±nƒ± otomatik olarak indir">
                            <field name="qnb_auto_fetch_outgoing"/>
                        </setting>
                        <setting id="qnb_auto_check" string="Durumu Otomatik Kontrol Et"
                                 help="G√∂nderilen belgelerin durumunu periyodik olarak kontrol et">
                            <field name="qnb_auto_check_status"/>
                        </setting>
                    </block>

                    <block title="QNB ƒ∞≈ülemleri (Manuel)" name="qnb_manual_actions" invisible="not qnb_enabled">
                        <setting id="qnb_action_fetch_all" string="QNB'den Belgeleri Al">
                            <div class="mt8">
                                <button name="action_qnb_fetch_all_documents" type="object"
                                        string="üì• T√ºm Belgeleri QNB'den Al" class="btn-primary" icon="fa-download"/>
                            </div>
                            <div class="text-muted mt8">
                                Uzun s√ºrebilir. B√ºy√ºk ar≈üivlerde i≈ülem s√ºresi uzar.
                            </div>
                        </setting>
                        <setting id="qnb_action_sync_partners" string="Partner G√ºncelleme">
                            <div class="mt8">
                                <button name="action_qnb_sync_partners_from_documents" type="object"
                                        string="üë§ Partnerleri XML'den G√ºncelle" class="btn-secondary" icon="fa-user"/>
                                <button name="action_qnb_fix_missing_partners_from_list" type="object"
                                        string="ü©π Partneri Bo≈ü Belgeleri (QNB Liste) D√ºzelt" class="btn-secondary" icon="fa-wrench"/>
                            </div>
                        </setting>
                        <setting id="qnb_action_match_docs" string="Belge E≈üle≈ütirme">
                            <div class="mt8">
                                <button name="action_qnb_bulk_match_documents" type="object"
                                        string="üîó Yevmiye Kayƒ±tlarƒ± ile E≈üle≈ütir" class="btn-secondary" icon="fa-link"/>
                                <button name="action_qnb_rematch_products" type="object"
                                        string="üîÑ √úr√ºnleri Yeniden E≈üle≈ütir" class="btn-secondary" icon="fa-refresh"/>
                            </div>
                        </setting>
                    </block>
                </app>
            </xpath>
        </field>
    </record>

    <!-- Config Settings Action -->
    <record id="action_qnb_config_settings" model="ir.actions.act_window">
        <field name="name">QNB e-Solutions Ayarlarƒ±</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="context">{'module': 'mobilsoft_qnb_efatura'}</field>
    </record>
</odoo>
