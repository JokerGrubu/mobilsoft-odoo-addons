<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     STOK MOD√úL√ú WRAPPER
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<t t-name="mobilsoft_interface.StockModule">
    <div class="ms-page">

        <div class="ms-page__header">
            <div>
                <h1 class="ms-page__title">üìä Stok Y√∂netimi</h1>
            </div>
            <div class="ms-page__actions" style="align-items:center">
                <button
                    t-attf-class="ms-btn ms-btn--sm {{ state.tab === 'levels' ? 'ms-btn--primary' : 'ms-btn--secondary' }}"
                    t-on-click="() => { state.tab = 'levels'; }"
                >üì¶ Stok Seviyeleri</button>
                <button
                    t-attf-class="ms-btn ms-btn--sm {{ state.tab === 'moves' ? 'ms-btn--primary' : 'ms-btn--secondary' }}"
                    t-on-click="() => { state.tab = 'moves'; }"
                >üîÑ Stok Hareketleri</button>
            </div>
        </div>

        <t t-if="state.tab === 'levels'">
            <StockLevels onAdjust="() => {}"/>
        </t>
        <t t-elif="state.tab === 'moves'">
            <StockMoves onBack="() => { state.tab = 'levels'; }"/>
        </t>

    </div>
</t>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     STOK SEVƒ∞YELERƒ∞
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<t t-name="mobilsoft_interface.StockLevels">
    <div>

        <!-- √ñzet kartlar -->
        <t t-if="!state.loading">
            <div class="ms-kpi-row" style="margin-bottom:20px">
                <div class="ms-kpi-card">
                    <div class="ms-kpi-card__icon">üì¶</div>
                    <div class="ms-kpi-card__value"><t t-esc="state.summary.totalProducts"/></div>
                    <div class="ms-kpi-card__label">Toplam √úr√ºn</div>
                </div>
                <div class="ms-kpi-card ms-kpi-card--danger">
                    <div class="ms-kpi-card__icon">‚ö†Ô∏è</div>
                    <div class="ms-kpi-card__value"><t t-esc="state.summary.outOfStock"/></div>
                    <div class="ms-kpi-card__label">Stok Yok</div>
                </div>
                <div class="ms-kpi-card ms-kpi-card--warning">
                    <div class="ms-kpi-card__icon">üìâ</div>
                    <div class="ms-kpi-card__value"><t t-esc="state.summary.lowStock"/></div>
                    <div class="ms-kpi-card__label">Kritik Stok (‚â§5)</div>
                </div>
            </div>
        </t>

        <!-- Ara√ß √ßubuƒüu -->
        <div class="ms-toolbar">
            <div class="ms-search">
                <span class="ms-search__icon">üîç</span>
                <input
                    class="ms-search__input"
                    type="text"
                    placeholder="√úr√ºn adƒ± veya barkod ara..."
                    t-att-value="state.search"
                    t-on-input="onSearch"
                />
            </div>
        </div>

        <!-- Filtreler -->
        <div style="display:flex; gap:6px; margin-bottom:16px; flex-wrap:wrap">
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'all' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('all')">T√ºm√º</button>
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'out' ? 'ms-btn--danger' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('out')">Stok Yok</button>
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'low' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('low')">Kritik Stok</button>
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'normal' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('normal')">Normal</button>
        </div>

        <!-- Tablo -->
        <div class="ms-table-container">
            <t t-if="state.loading">
                <div class="ms-spinner">Stok bilgileri y√ºkleniyor...</div>
            </t>
            <t t-elif="state.records.length === 0">
                <div class="ms-empty">
                    <div class="ms-empty__icon">üì¶</div>
                    <p class="ms-empty__title">√úr√ºn bulunamadƒ±</p>
                    <p class="ms-empty__desc">Arama kriterini deƒüi≈ütirin.</p>
                </div>
            </t>
            <t t-else="">
                <table class="ms-table">
                    <thead>
                        <tr>
                            <th>√úr√ºn Adƒ±</th>
                            <th>Barkod</th>
                            <th>Kategori</th>
                            <th style="text-align:right">Mevcut Stok</th>
                            <th style="text-align:right">Tahmini Stok</th>
                            <th style="text-align:right">Birim Maliyet</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="state.records" t-as="rec" t-key="rec.id">
                            <t t-set="status" t-value="getStockStatus(rec)"/>
                            <tr>
                                <td style="font-weight:600"><t t-esc="rec.name"/></td>
                                <td style="font-family:monospace; color:#666; font-size:12px">
                                    <t t-esc="rec.barcode || '‚Äî'"/>
                                </td>
                                <td><t t-esc="rec.categ_id ? rec.categ_id[1] : '‚Äî'"/></td>
                                <td t-attf-style="text-align:right; font-weight:700; color:{{ rec.qty_available &lt;= 0 ? '#D62828' : (rec.qty_available &lt;= 5 ? '#E07B00' : '#2D6A4F') }}">
                                    <t t-esc="formatQty(rec.qty_available)"/>
                                    <span style="font-size:11px; font-weight:400; color:#999; margin-left:2px">
                                        <t t-esc="rec.uom_id ? rec.uom_id[1] : ''"/>
                                    </span>
                                </td>
                                <td style="text-align:right; color:#666">
                                    <t t-esc="formatQty(rec.virtual_available)"/>
                                </td>
                                <td style="text-align:right">
                                    <t t-esc="formatPrice(rec.standard_price)"/>
                                </td>
                                <td>
                                    <span t-attf-class="ms-badge {{ status.cls }}">
                                        <t t-esc="status.label"/>
                                    </span>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>

                <div class="ms-pagination">
                    <span class="ms-pagination__info">
                        <t t-esc="pageStart"/> ‚Äì <t t-esc="pageEnd"/> / <t t-esc="state.total"/> √ºr√ºn
                    </span>
                    <div class="ms-pagination__controls">
                        <button class="ms-pagination__btn" t-att-disabled="state.offset &lt;= 0" t-on-click="prevPage">‚óÄ √ñnceki</button>
                        <span style="padding: 5px 12px; font-size:13px"><t t-esc="currentPage"/> / <t t-esc="totalPages"/></span>
                        <button class="ms-pagination__btn" t-att-disabled="state.offset + state.limit >= state.total" t-on-click="nextPage">Sonraki ‚ñ∂</button>
                    </div>
                </div>
            </t>
        </div>
    </div>
</t>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     STOK HAREKETLERƒ∞
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<t t-name="mobilsoft_interface.StockMoves">
    <div>
        <!-- Ara√ß √ßubuƒüu -->
        <div class="ms-toolbar">
            <div class="ms-search">
                <span class="ms-search__icon">üîç</span>
                <input
                    class="ms-search__input"
                    type="text"
                    placeholder="Transfer no veya kaynak ara..."
                    t-att-value="state.search"
                    t-on-input="onSearch"
                />
            </div>
        </div>

        <!-- Filtreler -->
        <div style="display:flex; gap:6px; margin-bottom:16px; flex-wrap:wrap">
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'done' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('done')">Tamamlananlar</button>
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'draft' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('draft')">Bekleyenler</button>
            <button t-attf-class="ms-btn ms-btn--sm {{ state.filter === 'all' ? 'ms-btn--primary' : 'ms-btn--secondary' }}" t-on-click="() => setFilter('all')">T√ºm√º</button>
        </div>

        <!-- Tablo -->
        <div class="ms-table-container">
            <t t-if="state.loading">
                <div class="ms-spinner">Stok hareketleri y√ºkleniyor...</div>
            </t>
            <t t-elif="state.records.length === 0">
                <div class="ms-empty">
                    <div class="ms-empty__icon">üîÑ</div>
                    <p class="ms-empty__title">Hareket bulunamadƒ±</p>
                </div>
            </t>
            <t t-else="">
                <table class="ms-table">
                    <thead>
                        <tr>
                            <th>Transfer No</th>
                            <th>T√ºr</th>
                            <th>Cari / Kaynak</th>
                            <th>Kaynak Belge</th>
                            <th>Planlanan Tarih</th>
                            <th>Tamamlanma</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="state.records" t-as="rec" t-key="rec.id">
                            <t t-set="badge" t-value="getStateBadge(rec.state)"/>
                            <tr>
                                <td style="font-family:monospace; font-weight:600">
                                    <t t-esc="rec.name"/>
                                </td>
                                <td style="font-size:12px; color:#666">
                                    <t t-esc="rec.picking_type_id ? rec.picking_type_id[1] : '‚Äî'"/>
                                </td>
                                <td><t t-esc="rec.partner_id ? rec.partner_id[1] : '‚Äî'"/></td>
                                <td style="font-size:12px; color:#666">
                                    <t t-esc="rec.origin || '‚Äî'"/>
                                </td>
                                <td><t t-esc="formatDate(rec.scheduled_date)"/></td>
                                <td><t t-esc="formatDate(rec.date_done)"/></td>
                                <td>
                                    <span t-attf-class="ms-badge {{ badge.cls }}">
                                        <t t-esc="badge.label"/>
                                    </span>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>

                <div class="ms-pagination">
                    <span class="ms-pagination__info">
                        <t t-esc="pageStart"/> ‚Äì <t t-esc="pageEnd"/> / <t t-esc="state.total"/> kayƒ±t
                    </span>
                    <div class="ms-pagination__controls">
                        <button class="ms-pagination__btn" t-att-disabled="state.offset &lt;= 0" t-on-click="prevPage">‚óÄ √ñnceki</button>
                        <span style="padding: 5px 12px; font-size:13px"><t t-esc="currentPage"/> / <t t-esc="totalPages"/></span>
                        <button class="ms-pagination__btn" t-att-disabled="state.offset + state.limit >= state.total" t-on-click="nextPage">Sonraki ‚ñ∂</button>
                    </div>
                </div>
            </t>
        </div>
    </div>
</t>

</templates>
